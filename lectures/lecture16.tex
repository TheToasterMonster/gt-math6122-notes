\chapter{Feb.~27 --- Factorization and Galois Theory}

\section{Factorization of Ideals in Relative Extensions}

\begin{remark}
  Let $L / K$ be a finite extension of number fields
  with $[L : K] = n$. Note that we also have an extension
  of number rings of the form $\OO_K \subseteq \OO_L$.
\end{remark}

\begin{exercise}
  Show the following:
  \begin{itemize}
    \item $\OO_L \cap K = \OO_K$;
    \item $\OO_L$ is a finitely generated $\OO_K$-module,
      generated by $n$ elements.
  \end{itemize}
\end{exercise}

\begin{remark}
  Let $L / K$ be a finite separable extension of
  fields of degree $n$, and let $B, A$ be Dedekind
  domains such that $A \subseteq K$ and
  $A \subseteq B \subseteq L$. We will assume that
  \begin{itemize}
    \item $B$ is integral over $A$;
    \item $B / \q$ and $A / \p$ are finite fields
      for all nonzero prime ideals $\q, \p$.
  \end{itemize}
\end{remark}

\begin{definition}
  A prime ideal $\q$ of $B$ \emph{lies over} $\p$
  of $A$ if $\q$ contains $\p$ (if and only if $\q | \p B$).
\end{definition}

\begin{lemma}
  In the above setting, $\q$ lies over $\p$ if and only
  if $\q \cap A = \p$.
\end{lemma}

\begin{proof}
  The key point is that if $\q \supseteq \p$, then
  $\q \cap A$ is a prime ideal containing $\p$.
  But $A$ is Dedekind, so it is $1$-dimensional, so
  we must have $\q \cap A = \p$.
\end{proof}

\begin{lemma}
  If $\p$ is a nonzero prime ideal of $A$, then
  $\p B \ne B$, i.e. $\p B$ is a proper ideal of $B$.
\end{lemma}

\begin{proof}
  Choose $\pi \in \p \setminus \p^2$. Since
  $\pi \in \p$, we have $\pi A = \p \mathfrak{a}$ for
  some ideal $\mathfrak{a}$ with $\p \nmid \mathfrak{a}$.
  Thus $(\p, \mathfrak{a}) = 1$, so
  \[
    1 = b + a, \quad b \in \p, a \in \mathfrak{a}.
  \]
  Suppose otherwise that $\p B = B$. Then
  $a B = a \p B \subseteq \pi B$. This means that
  $a = \pi x$ for some $x \in B$, so
  $x = a / \pi \in K$. But then
  $x \in B \cap K = A$, so $a \in \pi A \subseteq \p$.
  This implies
  $1 = b + a \in \p$, a contradiction.
\end{proof}

\begin{theorem}
  Let $\p \subseteq A$ be a prime ideal.
  If $\p B = \q_1^{e_1} \cdots \q_r^{e_r} \subseteq B$, then
  \[
    \sum_{i = 1}^r e(\q_i / \p) f(\q_i / \p) = [L : K],
  \]
  where $e(\q_i / \p) = e_i$ and
  $f(\q_i / \p) = [B / \q_i : A / \p]$.
\end{theorem}

\begin{proof}
  Let $S = A \setminus \p \subseteq A \subseteq B$.
  We claim that we can replace $B$ by $S^{-1} B = B'$ and
  $A$ by $S^{-1} A = A'$ without changing any of the
  above numerical invariants ($e$ or $f$).
  This is because we have $A / \p \cong A' / \p'$ and
  $B / \q' \cong B' / \q_i'$, and if
  $\p B = \q_1^{e_1} \cdots \q_r^{e_r}$, then
  $\p B' = \q_1'^{e_1} \cdots \q_r'^{e_r}$.

  Then $A'$ is a PID, so the same argument we used
  over $\Z$ will work.
\end{proof}

\begin{corollary}
  Let $\p \subseteq \OO_K$ be a prime ideal.
  If $\p \OO_L = \q_1^{e_1} \cdots \q_r^{e_r} \subseteq \OO_L$, then
  \[
    \sum_{i = 1}^r e(\q_i / \p) f(\q_i / \p) = n,
  \]
  where $e(\q_i / \p) = e_i$ and
  $f(\q_i / \p) = [\OO_L / \q_i : \OO_K / \p]$.
\end{corollary}

\section{Connections to Galois Theory}

\begin{prop}
  If $L / K$ is Galois, then $\Gal(L / K)$ acts
  transitively on the set $\{\q_1, \dots, \q_r\}$
  of prime ideals of $B$ lying over $\p$.
\end{prop}

\begin{proof}
  It is clear to see that $\Gal(L / K)$ acts on
  $\{\q_1, \dots, \q_r\}$: If
  $\q \cap A = \p$ and $\sigma \in \Gal(L / K)$,
  then
  \[\sigma(\q) \cap A = \sigma(\q \cap A) = \sigma(\p) = \p.\]
  To see that the action is transitive, let
  $\q_i, \q_j$ be two distinct prime ideals of $B$ lying
  over $\p$, and assume otherwise that
  $\q_i \ne \q_j$ for every $\sigma \in \Gal(L / K)$.
  By the Chinese remainder theorem, we can solve
  \[
    x \equiv 0 \Pmod{\q_j}, \quad x \equiv 1 \Pmod{\sigma(\q_i)}
  \]
  for all $\sigma \in \Gal(L / K)$, with $x \in B$.
  Now we have
  \[
    N_{L / K}(x) = \prod_{\sigma \in \Gal(L / K)} \sigma(x)
    \in B \cap K = A.
  \]
  Thus $N_{L / K}(x) \in \q_j \cap A = \p$. Note that
  $x \notin \sigma(\q_i)$ for all $\sigma$, so
  $\sigma(x) \notin \q_i$ for all $\sigma$.
  Since $\p B \subseteq \q_i$,
  \[
    \prod_{\sigma \in \Gal(L / K)} \sigma(x) \in \p B
    \subseteq \q_i,
  \]
  which implies $\sigma(x) \in \q_i$ for some
  $\sigma \in \Gal(L / K)$ since $\q_i$ is a prime ideal.
  Contradiction.
\end{proof}

\begin{corollary}
  If $L / K$ is Galois, then
  \[
    e(\q_1 / \p) = \cdots = e(\q_r / \p) = e \quad \text{and} \quad
    f(\q_1 / \p) = \cdots = f(\q_r / \p) = f,
  \]
  so we have the equality $efr = n$.
\end{corollary}

\begin{proof}
  Applying $\sigma$ to $\p B = \q_1^{e_1} \cdots \q_r^{e_r}$,
  we have $\p B = \sigma(\q_1)^{e_1} \cdots \sigma(\q_r)^{e_r}$.
  For any $i, j$, we can find $\sigma$ with $\sigma(\q_i) = \q_j$,
  so by unique factorization we have $e_i = e_j$.
  For $f$, note that we have an induced map
  \[
    \sigma : B / \q_i \to B / \q_j.
  \]
  Since $\sigma$ is an automorphism, it is easy to
  see that $\sigma$ is an isomorphism, so that
  $f_i = f_j$.
\end{proof}

\begin{remark}
  Let $L / K$ be Galois, and $B, A$ be Dedekind
  domains with $A \subseteq K$ and $A \subseteq B \subseteq L$.
  Fix a prime ideal $\p \subseteq A$ and let
  $S = \{\q_1, \dots, \q_r\}$ be the set of prime
  ideals lying over $\p$. Then $G = \Gal(L / K)$ acts
  transitively on $S$, with $|G| = n = efr$ and
  $|S| = r$.

  So by the orbit-stabilizer theorem,
  the stabilizer of any $\q_i$ has order $ef$.
  Fix some $\q \in S$, define the
  \emph{decomposition group} $D_\q = D_{\q / \p}$
  of $\q / \p$ to be the stabilizer of $\q$, i.e.
  \[
    D_{\q / \p} = \{\sigma \in G : \sigma(\q) = \q\}.
  \]
  Let $\ell = B / \q$ and $k = A / \p$, so that
  $|{\Gal(\ell / k)}| = f$.
\end{remark}

\begin{theorem}[Frobenius]
  There is a natural surjective homomorphism
  \begin{center}
  \begin{tikzcd}
    D_{\q / \p} \ar[r, twoheadrightarrow] & \Gal(\ell / k).
  \end{tikzcd}
  \end{center}
\end{theorem}

\begin{proof}
  Let $\sigma \in D_{\q / \p}$. We want to define
  $\overline{\sigma} \in \Gal(\ell / k)$. Take
  $\overline{x} \in \ell$ and lift it to some $x \in B$.
  Define
  \[
    \overline{\sigma}(\overline{x}) = \sigma(x) \Mod{q}.
  \]
  To see that this is well-defined, note that if
  $x_1, x_2$ are two lifts, then
  $x_1 - x_2 \in \q$, so
  \[
    \sigma(x_1) - \sigma(x_2) \in \sigma(\q) = \q.
  \]
  Let $\overline{\alpha}$ be a primitive element
  for $\ell / k$ (recalling that we are assuming
  $\ell / k$ is finite separable). To
  prove surjectivity, it suffices to show that every
  Galois conjugate of $\overline{\alpha}$ is of the
  form $\overline{\sigma}(\overline{\alpha})$ for some
  $\sigma \in D_{\q / \p}$. Let $\alpha \in B$
  be a lift of $\overline{\alpha}$ such that
  $\alpha \in \q'$ for all $\q' \in S$, $\q' \ne \q$.
  This follows by the Chinese remainder theorem, which
  gives a solution to the following system of
  congruences:
  \[
    \alpha \equiv \overline{\alpha} \Pmod{\q}, \quad
    \alpha \equiv 0 \Pmod{\q'} \text{ for } \q' \ne \q.
  \]
  Let $f \in A[x]$ be the minimal polynomial of
  $\alpha$ and $\overline{g} \in k[x]$ be the
  minimal polynomial of $\overline{\alpha}$. We have
  \[
    f(x) = \prod_{\sigma \in H} (x - \sigma(\alpha))
  \]
  for some subset $H \subseteq G$. Let
  $H' = H \cap D_\q$. We claim that
  $\sigma(\alpha) \in \q$ whenever $\sigma \in G$
  and $\sigma \notin D_\q$. This is because
  $\sigma \notin D_\q$ gives $\sigma^{-1} \notin D_\q$,
  so $\sigma^{-1} (\q) \ne \q$, hence
  $\alpha \in \sigma^{-1}(\q)$ and
  $\sigma(\alpha) \in \q$.
  Let $\overline{f} = f \Mod{\q}$, so
  \[
    \overline{f}(x)
    = \prod_{\sigma \in H} (x - \overline{\sigma(\alpha)})
    = \prod_{\sigma \in H'} (x - \overline{\sigma(\alpha)})
    \prod_{\sigma \notin H'} (x - \overline{\sigma(\alpha)})
    = x^m \prod_{\sigma \in H'} (x - \overline{\sigma}(\overline{\alpha})).
  \]
  So all nonzero roots of $\overline{f}(x)$ have
  the form $\overline{\sigma}(\overline{\alpha})$ for
  some $\sigma \in D_\q$. Finally, note that
  \[
    \overline{f}(\overline{\alpha})
    = \overline{f(\alpha)} = 0,
  \]
  so $\overline{g} | \overline{f}$. Note that $0$ is
  not a root of $\overline{g}$ (since $\overline{g}$
  is the minimal polynomial of a nonzero element), so
  \[
    \overline{g} \mid \prod_{\sigma \in H'} (x - \overline{\sigma(\alpha)}).
  \]
  This shows the result for any root of
  $\overline{g}$, which completes the proof.
\end{proof}

\begin{corollary}
  Let the \emph{inertia group} $I_{\q / \p}$ be the
  kernel of the above map. Then $|I_{\q / \p}| = e$.
\end{corollary}

\begin{proof}
  This is by the first isomorphism theorem, since
  $|D_{\q / \p}| = ef$ and $|{\Gal(\ell / k)}| = f$.
\end{proof}
